<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <title>çƒŸç«å¯„å¿ƒï¼Œæ„¿ä½ å®‰å¥½</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
      height: 100vh;
      overflow: hidden;
      font-family: "Microsoft YaHei", sans-serif;
      color: #fff;
      display: flex;
      justify-content: center;
      align-items: center;
      text-align: center;
    }
    #message {
	  position: relative;
	  z-index: 10;
	  font-size: 2rem;
	  text-shadow: 0 0 10px #00eeff, 0 0 20px #00eeff;
	  animation: pulse 3s infinite alternate;
	  max-width: 90%;
	  pointer-events: none;
	  transform: translateY(-20px); 
    }
    #click-hint {
      margin-top: 24px;
      font-size: 1.3rem;
      color: #00eeff;
      text-shadow:
        0 0 8px #00eeff,
        0 0 16px #00eeff,
        0 0 24px rgba(0, 238, 255, 0.7);
      letter-spacing: 2px;
      animation: 
        glow 2s infinite alternate,
        float 3s ease-in-out infinite;
      cursor: pointer;
      user-select: none;
      pointer-events: auto;
    }
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }
    @keyframes glow {
      from { text-shadow: 0 0 8px #00eeff, 0 0 16px #00eeff; }
      to   { text-shadow: 0 0 16px #00ffff, 0 0 32px #00eeff, 0 0 48px rgba(0, 255, 255, 0.8); }
    }
    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50%      { transform: translateY(-8px); }
    }
    canvas {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }
    #audio-tip {
      position: absolute;
      bottom: 20px;
      color: rgba(0, 238, 255, 0.7);
      font-size: 0.9rem;
      z-index: 20;
      opacity: 0;
      transition: opacity 0.5s;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* === å½©è›‹å®¹å™¨ï¼šæ•´ä½“å¯ç‚¹å‡» === */
    #easter-egg-container {
      display: inline-flex;
      align-items: center;
      opacity: 0;
      transition: opacity 0.5s ease;
      margin-left: 8px;
      cursor: pointer;
      user-select: none;
    }
    #easter-egg-icon {
      font-size: 1.3rem;
    }
    #easter-egg-text {
      font-size: 0.85rem;
      margin-left: 6px;
      white-space: nowrap;
    }

    /* é—ªçƒåŠ¨ç”» */
    #easter-egg-container.show:not(.cooldown) {
      animation: blinkContainer 1.8s infinite;
    }
    #easter-egg-container.cooldown #easter-egg-text {
      color: #aaa;
      text-shadow: none;
    }
    #easter-egg-container.cooldown #easter-egg-icon {
      opacity: 0.6;
    }

    @keyframes blinkContainer {
      0%, 100% { opacity: 1; }
      50%      { opacity: 0.6; }
    }

    /* === åŠ¨æ€å¼¹çª—åŸºç¡€æ ·å¼ === */
    .dynamic-popup {
      position: fixed;
      padding: 8px 14px;
      border-radius: 12px;
      font-size: 0.95rem;
      font-weight: 600;
      text-align: center;
      pointer-events: none;
      z-index: 1000;
      opacity: 0;
      white-space: normal;
      max-width: 65vw;
      word-break: break-word;
      transform: translateX(-50%);
      left: 50%;
    }

    /* === ä¼˜åŒ–åçš„æ­Œè¯/ç¥ç¦è¯­åŒºåŸŸ === */
    #lyrics {
      position: fixed;
      bottom: 120px;
      left: 50%;
      transform: translateX(-50%);
      color: rgba(255, 255, 255, 0.88);
      font-size: 1.1rem;
      text-align: center;
      max-width: 75%;
      z-index: 30;
      opacity: 0;
      line-height: 2.2;
      letter-spacing: 0.5px;
      font-style: normal;
      white-space: pre-line;
      text-shadow: 0 0 6px rgba(100, 200, 255, 0.5);
      animation: floatLyric 10s ease-in-out infinite;
      font-family: "Microsoft YaHei", "PingFang SC", sans-serif;
      padding: 12px 20px;
      background: rgba(10, 8, 25, 0.25);
      backdrop-filter: blur(2px);
      border-radius: 12px;
    }

    @keyframes floatLyric {
      0%, 100% { transform: translateX(-50%) translateY(0); }
      50%       { transform: translateX(-50%) translateY(-6px); }
    }
  </style>
</head>
<body>
  <div id="message">
    æƒ…äººèŠ‚å¿«ä¹ï¼Œæ„¿ä½ å®‰å¥½
    <div id="click-hint">âœ¨ ç‚¹å‡»æ”¾çƒŸèŠ± âœ¨</div>
  </div>
  <div id="audio-tip">
    ğŸµ éŸ³ä¹å·²å¼€å¯ Â· ã€ŠBiscuit and Teaã€‹
    <div id="easter-egg-container">
      <span id="easter-egg-icon">ğŸ</span>
      <span id="easter-egg-text">ç‚¹å‡»æœ‰æƒŠå–œ</span>
    </div>
  </div>
  <div id="lyrics"></div>
  <canvas id="canvas"></canvas>

  <audio id="bgm" loop preload="auto">
    <source src="biscuit-and-tea.mp3" type="audio/mpeg">
  </audio>

  <script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const bgm = document.getElementById('bgm');
    const audioTip = document.getElementById('audio-tip');
    const lyricsEl = document.getElementById('lyrics');
    const easterEggContainer = document.getElementById('easter-egg-container');
    const easterEggText = document.getElementById('easter-egg-text');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    window.addEventListener('resize', () => {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    });

    const letterLines = [
      "è‡´èˆ’èˆ’ï¼š",
      "æ„¿ä½ ç”Ÿæ´»å¦‚çƒŸèŠ±ç»šçƒ‚ï¼Œå¿ƒæƒ…å¦‚æ­Œè½»å¿«;",
      "ä¸å®¶äººå…±åº¦è‰¯è¾°ï¼Œå²å²å¹³å®‰å–œä¹,",
      "é˜–å®¶é¡ºé‚å®‰åº·ï¼Œå¹´å¹´å¸¸æ¬¢æ„‰ã€‚",
      "æƒ…äººèŠ‚å¿«ä¹ï¼Œæ„¿ä½ å®‰å¥½ã€‚"
    ];

    let currentLineIndex = 0;
    let currentCharIndex = 0;
    let accumulatedText = "";
    let isTyping = false;

    function typeCurrentLine() {
      if (currentLineIndex >= letterLines.length) {
        isTyping = false;
        setTimeout(() => {
          if (!easterEggContainer.dataset.shown) {
            easterEggContainer.classList.add('show');
            easterEggContainer.dataset.shown = 'true';
            easterEggContainer.addEventListener('click', handleEasterClick);
          }
        }, 1000);
        return;
      }

      const currentLine = letterLines[currentLineIndex];
      if (currentCharIndex <= currentLine.length) {
        const currentLineTyped = currentLine.substring(0, currentCharIndex);
        let displayText = accumulatedText + currentLineTyped;
        lyricsEl.textContent = displayText;
        currentCharIndex++;

        let delay = 90;
        const lastChar = currentLine.charAt(currentCharIndex - 1);
        if (['ã€‚', 'ï¼Œ', 'ï¼', 'ï¼Ÿ', 'â€¦'].includes(lastChar)) {
          delay = 350;
        } else if (lastChar === ' ') {
          delay = 130;
        }
        setTimeout(typeCurrentLine, delay);
      } else {
        accumulatedText += currentLine + "\n";
        currentLineIndex++;
        currentCharIndex = 0;
        setTimeout(typeCurrentLine, 1200);
      }
    }

    function startLyricsScroll() {
      if (isTyping) return;
      lyricsEl.style.opacity = '1';
      currentLineIndex = 0;
      currentCharIndex = 0;
      accumulatedText = "";
      isTyping = true;
      lyricsEl.textContent = "";
      setTimeout(typeCurrentLine, 1000);
    }

    // === åˆ†ç±»æ–‡æ¡ˆåº“ï¼ˆæŒ‰æƒé‡ï¼š40% å®¶åº­ / 30% æ„¿æ™¯ / 20% å¹½é»˜ / 10% èººå¹³ï¼‰===
    const messageCategories = {
      family: [
        "â¤ï¸æ„¿çˆ¸å¦ˆèº«ä½“å®‰åº·ï¼Œç¬‘å®¹å¸¸åœ¨ğŸ˜Š",
        "ğŸ¡å®¶äººå¹³å®‰ï¼Œä¾¿æ˜¯æœ€å¤§çš„ç¦æ°”ğŸŒŸ",
        "ğŸ‘µğŸ‘´çˆ¶æ¯åº·å¥ï¼Œå²æœˆé™å¥½ï¼Œå¿ƒæœ‰æ‰€ä¾ğŸ’–",
        "ğŸ®é˜–å®¶å¹¸ç¦ï¼Œå›¢åœ†å¸¸åœ¨ï¼Œç¯ç«å¯äº²ğŸ’«",
        "âœ¨æ„¿å®¶ä¸­ç‚ŠçƒŸè¢…è¢…ï¼Œäº²äººæ— ç—…æ— ç¾ğŸ¥£",
        "ğŸ™çˆ¸å¦ˆå°‘æ“å¿ƒï¼Œå¤šäº«æ¸…ç¦ï¼Œåƒå¥½ç¡é¦™ğŸ›Œ",
        "ğŸ•¯ï¸å®¶æ˜¯æ¸¯æ¹¾ï¼Œæ„¿å®ƒæ°¸è¿œæ¸©æš–æ˜äº®ğŸŒˆ",
        "ğŸæ„¿çˆ¶æ¯è…¿è„šçµä¾¿ï¼Œçœ¼æ˜å¿ƒäº®ï¼Œèƒƒå£å€å„¿æ£’ï¼",
        "ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ä¸€å®¶å’Œå’Œç¾ç¾ï¼Œèƒœè¿‡ä¸‡åƒå¯Œè´µğŸ’°",
        "ğŸŒ¸æ„¿äº²æƒ…é•¿å­˜ï¼Œå²å²å¹´å¹´çš†æ¬¢æ„‰ ğŸ‹",
        "ğŸ²å¹´å¤œé¥­æ¡Œä¸Šï¼Œç¬‘å£°æ¯”èœè¿˜é¦™ğŸ˜‹",
        "ğŸ§§å²å²å¹³å®‰ï¼Œå¹´å¹´æœ‰ä»Šæ—¥ï¼Œå®¶å®¶æœ‰å›¢åœ†ğŸ®",
        "ğŸŒ¼çˆ¸å¦ˆçš„ç¬‘å®¹ï¼Œæ˜¯æˆ‘æœ€å¤§çš„æ–°å¹´æ„¿æœ›ğŸ’•",
        "ğŸ›ï¸çˆ¶æ¯ç¡å¾—å®‰ç¨³ï¼Œå­©å­æ¢¦å¾—é¦™ç”œï¼Œè¶³çŸ£ğŸŒ™",
        "ğŸ«¶å­æ¬²å…»ï¼Œäº²å¸¸åœ¨â€”â€”è¿™ä¾¿æ˜¯äººé—´è‡³å¹¸â¤ï¸",
        "ğŸµèŒ¶æš–ï¼Œé¥­é¦™ï¼Œè¯å®¶å¸¸ï¼Œå°±æ˜¯æœ€å¥½çš„å¹´ğŸ¥¢",
        "ğŸŒŸä¸æ±‚å¤§å¯Œå¤§è´µï¼Œåªæ„¿å…¨å®¶æ— æ™å®‰åº·ğŸ¤²",
        "ğŸæœ€å¥½çš„ç¤¼ç‰©ï¼Œæ˜¯é™ªä»–ä»¬æ…¢æ…¢å˜è€ğŸ‘µğŸ‘´",
        "ğŸ’–å®¶äººåœ¨ï¼Œç¯äº®ç€ï¼Œå¿ƒå°±å®‰äº†ğŸ’¡",
        "ğŸ“¸å…¨å®¶ç¦é‡Œï¼Œä¸€ä¸ªéƒ½ä¸èƒ½å°‘âœ¨",
        "ğŸ‘µğŸ‘´æ„¿çˆ¸å¦ˆçš„æœ‹å‹åœˆï¼Œå…¨æ˜¯æ—…æ¸¸å’Œå¹¿åœºèˆğŸ’ƒ"
      ],
      vision: [
        "ğŸŒŸæ„¿ä½ æ–°å¹´èƒœæ—§å¹´ï¼Œæ¬¢å–œå¸¸ç›¸ä¼´ğŸŒ",
        "âœ¨å¿ƒä¹‹æ‰€å‘ï¼Œçš†æ˜¯é˜³å…‰ğŸŒ",
        "ğŸ†çƒŸç«ç…§å¤œç™½ï¼Œå–œä¹æ»¡å¿ƒæ€€ğŸ‡",
        "ğŸŒˆæ‰€æ±‚çš†å¦‚æ„¿ï¼Œæ‰€è¡ŒåŒ–å¦é€”âœ¨",
        "ğŸŒæ—¥æœ‰å°æš–ï¼Œå²æœ‰æ¸…æ¬¢ğŸ‚",
        "ğŸŒ¸æ˜¥é£åé‡Œï¼Œä¸å¦‚ä½ ç¬‘é¥å¦‚èŠ±ğŸ˜",
        "ğŸ’æ„¿çˆ±ä¸å¥½è¿ï¼Œå¦‚çƒŸèŠ±èˆ¬ä¸ºä½ ç»½æ”¾ğŸ‰",
        "ğŸ¤—æ–°çš„ä¸€å¹´ï¼Œè¢«ä¸–ç•Œæ¸©æŸ”ä»¥å¾…ğŸ’•",
        "ğŸ‘€çœ¼é‡Œæœ‰å…‰ï¼Œå¿ƒä¸­æœ‰çˆ±ï¼Œè„šä¸‹æœ‰è·¯ğŸŒˆ",
        "ğŸ’å¹³å®‰å–œä¹ï¼Œä¸‡äº‹èƒœæ„ğŸ™",
        "ğŸŒ»ç”Ÿæ´»æ˜æœ—ï¼Œä¸‡ç‰©å¯çˆ±ğŸ¾",
        "ğŸ’–æ„¿ä½ æ‰€å¾—çš†æ‰€æœŸï¼Œæ‰€å¤±äº¦æ— ç¢ğŸŒŸ",
        "ğŸˆæ„¿æ¯ä¸€ä¸ªæ˜å¤©éƒ½æ¯”ä»Šå¤©æ›´ç¾å¥½ğŸŒˆ",
        "ğŸŒ„å‰æ–¹çš„è·¯ï¼Œæ€»æœ‰æƒŠå–œåœ¨ç­‰å¾…ğŸŒŸ",
        "ğŸ’šç¥ç¦å¦‚æ˜¥é£ï¼Œä¼´éšä½ å·¦å³ğŸŒ¬ï¸",
        "ğŸ§¡æ¯ä¸€å¤©éƒ½æœ‰æ–°çš„å¸Œæœ›å’Œæ¢¦æƒ³â˜€ï¸ğŸŒˆ",
        "ğŸ’œæ„¿ä½ çš„ç”Ÿæ´»å……æ»¡è‰²å½©å’Œæ¬¢ä¹ğŸ¨",
        "ğŸ’—è®°ä½é‚£äº›ç¾å¥½çš„ç¬é—´ï¼Œè®©å®ƒä»¬æˆä¸ºæ°¸æ’â­",
        "ğŸŒ±æ…¢æ…¢æ¥ï¼Œæ¯”è¾ƒå¿«ï¼›ç¨³ç¨³èµ°ï¼Œç»ˆä¼šåˆ°",
        "ğŸ’°æš´å¯Œï¼å­˜æ¬¾ç¿»å€ä¸æ˜¯æ¢¦ï¼ğŸ’°",
        "ğŸ’„å˜ç¾ï¼é¢œå€¼å¼€æŒ‚ï¼Œç´ é¢œå‘å…‰ï¼âœ¨",
        "ğŸ’˜è„±å•ï¼æ­£ç¼˜é€Ÿé€Ÿå‡ºç°ï¼ğŸ’Œ",
        "ğŸ§§çº¢åŒ…æ‹¿åˆ°æ‰‹è½¯ï¼ğŸ§§",
        "ğŸ†å‡èŒåŠ è–ªï¼è€æ¿ä¸»åŠ¨æ¶¨å·¥èµ„ï¼ğŸ“ˆ",
        "âœˆï¸è¯´èµ°å°±èµ°çš„æ—…è¡Œå®‰æ’ä¸Šï¼ğŸŒ",
        "ğŸ“šå­¦ä¹ å¼€æŒ‚ï¼Œè€ƒè¯•å…¨è¿‡ï¼ğŸ’¯",
        "ğŸ§˜â€â™€ï¸å¿ƒæ€è¶…ç¨³ï¼Œçƒ¦æ¼é€€æ•£ï¼â˜ï¸",
        "ğŸ›ï¸ç¡åˆ°è‡ªç„¶é†’ï¼Œä¸ç”¨è®¾é—¹é’Ÿï¼â°âŒ",
        "ğŸ›’ä¹°ä¹°ä¹°ä¸å¿ƒç–¼ï¼ğŸ’³âœ¨",
        "ğŸ‚ç”Ÿæ—¥æ„¿æœ›å…¨éƒ¨å®ç°ï¼âœ¨",
        "ğŸŒˆå¥½è¿å€¼æ‹‰æ»¡ï¼Œé”¦é²¤é™„ä½“ï¼ğŸŸ",
        "âœ¨è‡ªä¿¡çˆ†æ£šï¼Œèµ°è·¯å¸¦é£ï¼ğŸ’¨",
        "ğŸ¯ç›®æ ‡è¾¾æˆï¼Œflag ä¸å€’ï¼ğŸš©",
        "ğŸ‘—è¡£æŸœçˆ†æ»¡ï¼Œç©¿å•¥éƒ½å¥½çœ‹ï¼ğŸ‘ ",
        "ğŸœåƒä¸èƒ–ä½“è´¨ï¼Œå¯åŠ¨ï¼âš¡",
        "ğŸ’Œæ”¶åˆ°å¿ƒåŠ¨çš„æ¶ˆæ¯ï¼ğŸ’Œ",
        "ğŸ¦å·¥èµ„åˆ°è´¦æ—¥ï¼Œæ˜¯æˆ‘æœ€æµªæ¼«çš„æƒ…äººèŠ‚ğŸ’˜",
        "ğŸ’ä¸æ±‚ä¸€å¤œæš´å¯Œï¼Œä½†æ±‚èŠ±å‘—é¢åº¦å†é«˜ç‚¹ï½âœ…"
      ],
      humor: [
        "æˆ¿ç§Ÿæœ‰ç‚¹è´µï¼Œä½†æˆ‘çš„æ¢¦æƒ³æ›´è´µğŸ âœ¨",
        "åœ°é“æŒ¤æˆæ²™ä¸é±¼ï¼Œä½†æˆ‘çš„è€³æœºé‡Œæ˜¯å…¨ä¸–ç•ŒğŸ§ğŸŒ",
        "è€æ¿è¯´â€˜å¤šåƒè‹¦â€™â€”â€”æˆ‘å›ï¼šé‚£å…ˆåŠ ç‚¹ç³–å§ï¼ğŸ¯ğŸ˜‰",
        "ä¼šè®®å¾ˆå¤šï¼Œä½†æˆ‘çš„æ‘¸é±¼æŠ€æœ¯æ›´ç²¾æ¹›ğŸŸğŸ˜",
        "å‘¨ä¸€ç»¼åˆå¾ï¼Ÿä¸å­˜åœ¨çš„ï¼æˆ‘ç›´æ¥å¼€å¯å‘¨æœ«æ¨¡å¼ğŸ“†â¡ï¸ğŸŒ´",
        "éœ€æ±‚å¤©å¤©æ”¹ï¼Ÿæ²¡å…³ç³»ï¼Œæˆ‘å¿ƒæ€å·²å‡çº§åˆ° v2.0ğŸš€",
        "ç”µè„‘å¶å°”è“å±ï¼Œä½†æˆ‘å¿ƒæƒ…æ°¸è¿œç²‰çº¢ğŸ’–",
        "å¹´ç»ˆå¥–ä¸å¤šï¼Œä½†ç¬‘å®¹ç®¡å¤ŸğŸ˜„",
        "KPI åƒæ˜Ÿæ˜Ÿï¼Œè™½è¿œä½†äº®âœ¨ â†’ æˆ‘è¿½ç€è·‘ï¼",
        "ä¸‹ç­æ—¶é—´åˆ°ï¼å·¥ä½è‡ªåŠ¨å¼¹å°„æˆ‘å›å®¶ğŸš€ğŸ ",
        "ç²¾ç¥ç”µé‡ä½ï¼Ÿå……ä¸ªåˆè§‰æ»¡è¡€å¤æ´»ğŸ”‹ğŸ˜´",
        "å›¢å»ºï¼Ÿåªè¦ä¸å ç”¨å‘¨æœ«ï¼Œæˆ‘éƒ½OKï¼ğŸ¤",
        "PPT è¦ç”µå½±çº§ï¼Ÿé‚£æˆ‘é…ä¹ç”¨ã€Šæ˜Ÿé™…ç©¿è¶Šã€‹ğŸ¬"
      ],
      chill: [
        "èººå¹³ä¸æ˜¯æ”¾å¼ƒï¼Œæ˜¯ç»™çµé­‚å……ç”µğŸ”‹ğŸ§ ",
        "ä»Šæ—¥æˆå°±ï¼šæˆåŠŸå‘¼å¸24å°æ—¶ğŸŒ¬ï¸âœ…",
        "æˆ‘çš„KPIï¼šå¥½å¥½æ´»ç€ï¼Œå¤©å¤©å¼€å¿ƒğŸ’“",
        "å…è®¸è‡ªå·±å¶å°”åšä¸ªåºŸç‰©ğŸ§¸âœ¨ â€”â€” æ˜å¤©å†å·",
        "æ…¢ä¸€ç‚¹ï¼Œä¹Ÿæ²¡å…³ç³»ğŸŒğŸŒˆ",
        "ä¸–ç•Œå¤ªåµï¼Œæˆ‘é€‰æ‹©é™éŸ³ï¼Œå¬è‡ªå·±çš„å¿ƒè·³ğŸ”‡â¤ï¸",
        "åŠªåŠ›è¿‡äº†ï¼Œå‰©ä¸‹çš„äº¤ç»™å®‡å®™å§ğŸ¤²ğŸŒŒ",
        "ä¸å·äº†ï¼Œä»Šå¤©ä¸»æ‰“ä¸€ä¸ªéšç¼˜+å¼€å¿ƒğŸ²ğŸƒ",
        "ç”µé‡ä¸è¶³ï¼Ÿé‚£å°±å…³æœºä¼‘æ¯ï¼Œæ˜å¤©é‡å¯ï¼ğŸ”ŒğŸ’¤",
        "ä¸åšç‰›é©¬ï¼Œåªåšå¿«ä¹çš„è‡ªå·±ğŸ®ğŸâ¡ï¸ğŸ‘‘",
        "æ‹’ç»å†…è€—ï¼Œä»å¤¸è‡ªå·±å¼€å§‹ï¼šä½ å¾ˆæ£’ï¼ğŸŒŸ",
        "åºŠä»¥å¤–çš„åœ°æ–¹éƒ½æ˜¯è¿œæ–¹â€¦â€¦ä½†ä»Šå¤©ä¸æƒ³å»ğŸ›ï¸ğŸŒ",
        "å‘å‘†æ˜¯æˆ‘ä»Šå¤©çš„é«˜å…‰æ—¶åˆ»â˜ï¸âœ¨",
        "ä¸äº‰ä¸æŠ¢ï¼Œå¿«ä¹æ— ä»·ğŸ•Šï¸ğŸ’",
        "äººç”Ÿä¸æ˜¯èµ›é“ï¼Œæ˜¯æ—·é‡â€”â€”æˆ‘æƒ³æ€ä¹ˆèµ°éƒ½è¡ŒğŸŒ¾ğŸš¶â€â™€ï¸",
        "å…è®¸è‡ªå·±ä»Šå¤©ä»€ä¹ˆéƒ½ä¸åšğŸ™…â€â™‚ï¸ğŸ›‹ï¸",
        "ä¼‘æ¯ä¸æ˜¯æ‡’ï¼Œæ˜¯åˆšéœ€ï¼Œæ›´æ˜¯æ™ºæ…§ğŸ›€â¤ï¸",
        "æˆ‘çš„æ–°å¹´è®¡åˆ’ï¼šå°‘ç„¦è™‘ï¼Œå¤šåƒé¥­ï¼Œå¸¸å¾®ç¬‘ğŸšğŸ˜Š"
      ]
    };

    // æƒé‡é…ç½®ï¼šfamily:40%, vision:30%, humor:20%, chill:10%
    const weights = [
      { key: 'family', weight: 40 },
      { key: 'vision', weight: 30 },
      { key: 'humor', weight: 20 },
      { key: 'chill', weight: 10 }
    ];

    function getRandomWeightedMessage() {
      // æ„å»ºç´¯ç§¯æƒé‡æ•°ç»„
      const totalWeight = weights.reduce((sum, w) => sum + w.weight, 0);
      let random = Math.random() * totalWeight;
      for (const { key, weight } of weights) {
        if (random < weight) {
          const category = messageCategories[key];
          return category[Math.floor(Math.random() * category.length)];
        }
        random -= weight;
      }
      // fallback
      return messageCategories.family[0];
    }

    const palettes = [
      { bg: 'rgba(255, 100, 200, 0.9)', color: '#fff', border: '#ff64c8' },
      { bg: 'rgba(100, 255, 200, 0.9)', color: '#000', border: '#64ffc8' },
      { bg: 'rgba(255, 200, 100, 0.9)', color: '#000', border: '#ffc864' },
      { bg: 'rgba(100, 150, 255, 0.9)', color: '#fff', border: '#6496ff' },
      { bg: 'rgba(200, 100, 255, 0.9)', color: '#fff', border: '#c864ff' },
      { bg: 'rgba(255, 255, 255, 0.9)', color: '#ff64c8', border: '#ff64c8' }
    ];

    function createPopup(text, x, y) {
      const popup = document.createElement('div');
      popup.className = 'dynamic-popup';
      const palette = palettes[Math.floor(Math.random() * palettes.length)];
      const fontSize = 0.88 + Math.random() * 0.25;
      
      Object.assign(popup.style, {
        backgroundColor: palette.bg,
        color: palette.color,
        border: `1.5px solid ${palette.border}`,
        boxShadow: `0 2px 6px rgba(0,0,0,0.2)`,
        fontSize: `${fontSize}rem`,
        left: `${x}px`,
        top: `${y - 40}px`,
        opacity: '0',
        transform: 'translateX(-50%) translateY(0)',
        transition: 'none'
      });

      popup.textContent = text;
      document.body.appendChild(popup);

      void popup.offsetWidth;

      Object.assign(popup.style, {
        opacity: '1',
        transform: `translateX(-50%) translateY(${ -8 - Math.random() * 8 }px)`,
        transition: 'opacity 0.3s, transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275)'
      });

      setTimeout(() => {
        popup.style.opacity = '0';
        popup.style.transform = 'translateX(-50%) translateY(-20px)';
        popup.style.transition = 'opacity 0.5s, transform 0.5s';
      }, 2300);

      setTimeout(() => {
        if (popup.parentNode) popup.parentNode.removeChild(popup);
      }, 2900);
    }

    class Particle {
      constructor(x, y, color) {
        this.x = x;
        this.y = y;
        this.color = color;
        this.radius = Math.random() * 1.8 + 0.7;
        this.velocity = { x: (Math.random() - 0.5) * 6, y: (Math.random() - 0.5) * 6 };
        this.alpha = 1;
        this.decay = Math.random() * 0.028 + 0.01;
      }
      draw() {
        ctx.save();
        ctx.globalAlpha = this.alpha;
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
        ctx.fillStyle = this.color;
        ctx.fill();
        ctx.closePath();
        ctx.restore();
      }
      update() {
        this.velocity.y += 0.03;
        this.x += this.velocity.x;
        this.y += this.velocity.y;
        this.alpha -= this.decay;
        this.draw();
        return this.alpha > 0;
      }
    }

    const colors = ['#ff64c8', '#64ffc8', '#ffc864', '#6496ff', '#c864ff', '#00eeff'];
    let particles = [];
    let musicPlayed = false;
    let lastTriggerTime = 0;
    const COOLDOWN_MS = 3000;

    function createFirework(x, y) {
      const color = colors[Math.floor(Math.random() * colors.length)];
      for (let i = 0; i < 70; i++) {
        particles.push(new Particle(x, y, color));
      }
    }

    function playMusic() {
      if (!musicPlayed) {
        bgm.volume = 0.3;
        bgm.play().then(() => {
          musicPlayed = true;
          audioTip.style.opacity = '1';
          startLyricsScroll();
        }).catch(e => console.log("Audio play blocked"));
      }
    }

    function animate() {
      requestAnimationFrame(animate);
      ctx.fillStyle = 'rgba(15, 12, 41, 0.07)';
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      particles = particles.filter(p => p.update());
    }

    document.addEventListener('click', (e) => {
      if (e.target.closest('#easter-egg-container')) return;
      const x = e.clientX;
      const y = e.clientY;
      createFirework(x, y);
      playMusic();
      const msg = getRandomWeightedMessage(); // â† ä½¿ç”¨æƒé‡éšæœº
      createPopup(msg, x, y);
    });

    function handleEasterClick(e) {
      e.stopPropagation();
      const now = Date.now();
      if (now - lastTriggerTime < COOLDOWN_MS) {
        easterEggText.textContent = "ç¨ç­‰å“¦ï½";
        setTimeout(() => {
          if (easterEggContainer.dataset.shown) {
            easterEggText.textContent = "ç‚¹å‡»æœ‰æƒŠå–œ";
          }
        }, 800);
        return;
      }

      lastTriggerTime = now;
      easterEggContainer.classList.add('cooldown');

      // å½©è›‹ç‚¹å‡»æ—¶ä»å±•ç¤ºå…¨éƒ¨æ–‡æ¡ˆï¼ˆä¸æŒ‰æƒé‡ï¼‰
      const allMessages = [
        ...messageCategories.family,
        ...messageCategories.vision,
        ...messageCategories.humor,
        ...messageCategories.chill
      ];
      const total = allMessages.length;
      for (let i = 0; i < total; i++) {
        setTimeout(() => {
          const x = 30 + Math.random() * (window.innerWidth - 60);
          const y = 50 + Math.random() * (window.innerHeight - 100);
          createPopup(allMessages[i], x, y);
          createFirework(x, y + 25);
        }, i * 12);
      }

      setTimeout(() => {
        easterEggContainer.classList.remove('cooldown');
      }, COOLDOWN_MS);
    }

    animate();
  </script>
</body>
</html>
